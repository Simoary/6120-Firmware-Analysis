!function(l){l.su.moduleManager.define("networkStatus",{services:["ajax"],models:["wanStatus","internetConnect","lanAdvLanModel","lanAdvLinkAggModel","iptvVlan","dhcpServer","ddnsAdv","ddnsAdvTplinkModel","ddnsAdvNoipModel","ddnsAdvDnydnsModel"],stores:["iptvVlanStore","ddnsAdvTplinkStore"],views:["networkStatusView"],listeners:{ev_on_launch:function(e,n,t,a,d,s,r){this.unRegisterAutoSaveData(a.ddnsAdv),n.refreshStatus(),n.refresh=setInterval(n.refreshStatus,1e4)}},init:function(e,o,i,n,t,a){this.configViews({id:"networkStatusView",items:[{id:"internet-conn-type",renderer:function(e){switch(e){case"dhcp":return l.su.CHAR.NETWORK_STATUS.DYNAMIC_IP;case"static":return l.su.CHAR.NETWORK_STATUS.STATIC_IP;case"pppoe":return l.su.CHAR.NETWORK_STATUS.PPPOE;case"l2tp":return l.su.CHAR.NETWORK_STATUS.L2TP;case"pptp":return l.su.CHAR.NETWORK_STATUS.PPTP;case"dslite":return l.su.CHAR.NETWORK_INTERNET.DSLITE;case"v6plus":return l.su.CHAR.NETWORK_INTERNET.V6_PLUS}}},{id:"dhcp-server-status",renderer:function(e){return"off"==e?l.su.CHAR.NETWORK_STATUS.DISABLED:l.su.CHAR.NETWORK_STATUS.ENABLED}},{id:"ddns-service-provider",renderer:function(e){switch(e){case 0:return l.su.CHAR.NETWORK_STATUS.TP_LINK;case 1:return l.su.CHAR.NETWORK_STATUS.NO_IP;case 2:return l.su.CHAR.NETWORK_STATUS.DNYDNS}}}]}),this.listen({"models.lanAdvLinkAggModel":{"ev_loaded":function(e,n,t){i.lanAdvLinkAggModel.getData();var a=i.lanAdvLinkAggModel.getData().ports,d=[];if("1"==i.lanAdvLinkAggModel.getData().enableAgg){for(var s=0;s<4;s++)a["lan"+(s+1)]&&(d[d.length]=l.su.CHAR.NETWORK_STATUS.LAN+" "+(s+1));var r=d.join(" & ");o.networkStatusView.lanLink.show(),o.networkStatusView.lanLink.setValue(r)}else o.networkStatusView.lanLink.hide()}},"models.iptvVlan":{"ev_loaded":function(e,n,t){"off"==i.iptvVlan.getData().enable?o.networkStatusView.iptvPanel.hide():o.networkStatusView.iptvPanel.show()}},"models.dhcpServer":{"ev_loaded":function(e,n,t){"off"==i.dhcpServer.getData().enable?i.dhcpServer.ipaddrStart.hide():i.dhcpServer.ipaddrStart.show()}},"models.lanAdvLanModel.maskType":{"ev_value_change":function(e,n,t){switch(n){case 0:i.lanAdvLanModel.maskType.setValue("255.255.255.0");break;case 1:i.lanAdvLanModel.maskType.setValue("255.255.0.0");break;case 2:i.lanAdvLanModel.maskType.setValue("255.0.0.0");break;case 3:i.lanAdvLanModel.maskType.setValue(i.lanAdvLanModel.customValue.getValue())}}},"models.dhcpServer.ipaddrEnd":{"ev_value_change":function(e,n,t){var a=i.dhcpServer.ipaddrStart.getValue();i.dhcpServer.ipaddrStart.setValue(a+"-"+n)}}})}},function(a,d,n,s,e,t){return{refreshStatus:function(){n.internetConnect.load(),n.wanStatus.load(),n.lanAdvLanModel.load(),n.lanAdvLinkAggModel.load(),n.iptvVlan.load(),s.iptvVlanStore.load({data:{operation:"read"},success:function(e){a.lanNum=4;for(var n=e.ports.split(" "),t=0;t<a.lanNum;t++)s.iptvVlanStore.getSubModelBindByIndex(t).lan.setLabelField("LAN"+n[t]);s.iptvVlanStore.show()}}),n.dhcpServer.load(),n.ddnsAdv.load({success:function(e){if("off"===e.enable)d.networkStatusView.ddnsPanel.hide();else switch(d.networkStatusView.ddnsPanel.show(),e.provider){case"tp-link":l.su.userInfo.token&&(s.ddnsAdvTplinkStore.load({success:function(e){a.setCurrentDomain(e)}}),d.networkStatusView.ddnsAdvTplink.show());break;case"noip":n.ddnsAdvNoipModel.load(),d.networkStatusView.ddnsAdvNoip.show();break;case"dyndns":n.ddnsAdvDnydnsModel.load(),d.networkStatusView.ddnsAdvDnydns.show()}}})},setCurrentDomain:function(e){for(var n="",t=e.length,a=0;a<t;a++)"occupied"===e[a].status&&(n=e[a].domain);d.networkStatusView.currentDomain.setValue(n)}}})}(jQuery);