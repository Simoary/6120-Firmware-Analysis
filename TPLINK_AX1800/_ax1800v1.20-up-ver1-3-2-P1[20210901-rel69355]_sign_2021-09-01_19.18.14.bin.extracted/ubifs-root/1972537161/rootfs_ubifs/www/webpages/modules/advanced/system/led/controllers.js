!function(r){r.su.moduleManager.define("led",{models:["ledControlModel","nightModeModel"],stores:[],services:["time","timer"],views:["ledView"],listeners:{"ev_on_launch":function(e,t,o,n,i,d,s){this.unRegisterAutoSaveData([n.ledControlModel]),this.startCheckLed(!0),n.nightModeModel.load()},"ev_before_destroy":function(e,t){t.beforeDestroy()}},init:function(n,i,s,e,t,d){this.configViews({}),this.listen({"models.nightModeModel.enable":{"ev_value_change":function(e,t,o){"on"===t?(i.ledView.nightModeFieldset.show(),d.time.on("on_time_change",n.onTimeChange),d.time.on("on_hour24_change",n.onHour24Change)):(i.ledView.nightModeFieldset.hide(),d.time.off("on_time_change",n.onTimeChange),d.time.off("on_hour24_change",n.onHour24Change))}},"models.nightModeModel.timeStart":{"ev_value_change":function(e,t,o){var n=t||"00:00",i=s.nightModeModel.timeEnd.getValue()||"00:00";if("string"==typeof n&&"string"==typeof i){var d=parseInt(n.replace(":",""),10);parseInt(i.replace(":",""),10)<=d?s.nightModeModel.timeEnd.setShortTips(r.su.CHAR.LED.NEXT_DAY_TIP):s.nightModeModel.timeEnd.setShortTips("&nbsp;")}}},"models.nightModeModel.timeEnd":{"ev_value_change":function(e,t,o){var n=s.nightModeModel.timeStart.getValue()||"00:00",i=t||"00:00";if("string"==typeof n&&"string"==typeof i){var d=parseInt(n.replace(":",""),10);parseInt(i.replace(":",""),10)<=d?s.nightModeModel.timeEnd.setShortTips(r.su.CHAR.LED.NEXT_DAY_TIP):s.nightModeModel.timeEnd.setShortTips("&nbsp;")}}}}),this.control({"#led-enable":{"ev_view_change":function(e,t){this.stopCheckLed(),s.ledControlModel.submit({success:function(){n.startCheckLed(!1)}})}}})}},function(e,i,o,t,n,d){var s=null;return{startCheckLed:function(e){s=d.timer.setInterval(this,function(){o.ledControlModel.load()},2900,e)},stopCheckLed:function(){d.timer.clearInterval(this,s),s=null},onTimeChange:function(e,t){var o=d.time.getHour24(),n=d.time.format(t,"yyyy-MM-dd HH:mm:ss",o);i.ledView.currentTime.setValue(n)},onHour24Change:function(e,t){t?(o.nightModeModel.timeEnd.setHourSystem("24"),o.nightModeModel.timeStart.setHourSystem("24")):(o.nightModeModel.timeEnd.setHourSystem("12"),o.nightModeModel.timeStart.setHourSystem("12"))},beforeDestroy:function(){d.time.off("on_time_change",e.onTimeChange),d.time.off("on_hour24_change",e.onHour24Change),this.stopCheckLed()}}})}(jQuery);