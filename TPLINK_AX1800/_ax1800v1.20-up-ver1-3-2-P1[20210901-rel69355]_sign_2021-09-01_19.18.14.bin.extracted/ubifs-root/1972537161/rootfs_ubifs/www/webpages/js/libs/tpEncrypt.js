!function(o){var r,t,n,e,i,p;o.encrypt=o.encrypt||{},o.encrypt.MD5=function(t,e){return CryptoJS.MD5(t,e).toString()},o.encrypt.rand=function(){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues){var e=new Uint32Array(1);return t.getRandomValues(e),e[0]/4294967296}return Math.random()},o.encrypt.getRandomIntInclusive=function(t,e){var r=Math.ceil(t),n=Math.floor(e);return Math.floor(o.encrypt.rand()*(n-r+1))+r},o.encrypt.generateRandomIntString=function(t){for(var e="";t--;)e+=o.encrypt.getRandomIntInclusive(0,9);return e},o.encrypt.AES=(r={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7},(t=function(){}).prototype.genKey=function(){var t=o.encrypt.generateRandomIntString(16),e=o.encrypt.generateRandomIntString(16);return this.key=t,this._keyUtf8=CryptoJS.enc.Utf8.parse(t),this.iv=e,this._ivUtf8=CryptoJS.enc.Utf8.parse(e),{key:t,iv:e}},t.prototype.setKey=function(t,e){"string"==typeof t&&16==t.length&&(this.key=t,this._keyUtf8=CryptoJS.enc.Utf8.parse(t)),"string"==typeof e&&16==e.length&&(this.iv=e,this._ivUtf8=CryptoJS.enc.Utf8.parse(e))},t.prototype.setStringKey=function(t){var e=t.split("&"),r=e[0].split("=")[1],n=e[1].split("=")[1];this.setKey(r,n)},t.prototype.getKey=function(){return{key:this.key,iv:this.iv}},t.prototype.getKeyString=function(t){return(t=t||"k=%key%&i=%iv%").replace("%key%",this.key).replace("%iv%",this.iv)},t.prototype.encrypt=function(t){var e=o.extend(r,{iv:this._ivUtf8});return CryptoJS.AES.encrypt(t,this._keyUtf8,e).toString()},t.prototype.decrypt=function(t){var e=o.extend(r,{iv:this._ivUtf8});return CryptoJS.AES.decrypt(t,this._keyUtf8,e).toString(CryptoJS.enc.Utf8)},t),o.encrypt.RSA=(n=o.su.encrypt,(e=function(){}).prototype.setKey=function(t,e){this.nn=t,this.ee=e},e.prototype.setStringKey=function(t){var e=t.split("&"),r=e[0].split("=")[1],n=e[1].split("=")[1];this.setKey(r,n)},e.prototype.encrypt=function(t,e,r){return n(t,[this.nn||e,this.ee||r])},e.prototype.getKeyString=function(t){return(t=t||"nn=%nn%&ee=%ee%").replace("%nn%",this.nn).replace("%ee%",this.ee)},e),o.encrypt.encryptor=((i=function(t){this.aes=new o.encrypt.AES,this.rsa=new o.encrypt.RSA}).prototype.setHash=function(){if(2==arguments.length){var t=arguments[0],e=arguments[1];this.hash=o.encrypt.MD5(t+e)}else{var r=arguments[0];this.hash=r}},i.prototype.getHash=function(){return this.hash},i.prototype.setSeq=function(t){this.seq=parseInt(t)},i.prototype.getSeq=function(t){return this.seq},i.prototype.genAESKey=function(){this.aes.genKey(),this.aesKeyString=this.aes.getKeyString()},i.prototype.getAESKey=function(){return this.aes.getKeyString()},i.prototype.setAESStringKey=function(t){this.aes.setStringKey(t),this.aesKeyString=t},i.prototype.setRSAKey=function(t,e){this.rsa.setKey(t,e)},i.prototype.setRSAStringKey=function(t){this.rsa.setStringKey(t)},i.prototype.getRSAKey=function(){return this.rsa.getKeyString()},i.prototype.getSignature=function(t,e){if(e)var r=this.aesKeyString+"&h="+this.hash+"&s="+t||this.seq;else r="h="+this.hash+"&s="+t||this.seq;for(var n="",o=0;o<r.length;)n+=this.rsa.encrypt(r.substr(o,53)),o+=53;return n},i.prototype.dataEncrypt=function(t,e){var r={},n=this.aes.encrypt(t),o=n.length;return r.sign=this.getSignature(this.seq+o,e),r.data=n,r},i.prototype.dataDecrypt=function(t){return this.aes.decrypt(t)},i),o.encrypt.encryptManager=((p=function(){}).prototype.genEncryptor=function(){return this.encryptor=new o.encrypt.encryptor,this.encryptor},p.prototype.recordEncryptor=function(){this.encryptor&&(localStorage.setItem("encryptorAES",this.encryptor.getAESKey()),localStorage.setItem("encryptorSeq",this.encryptor.getSeq()),localStorage.setItem("encryptorHash",this.encryptor.getHash()),localStorage.setItem("encryptorRsa",this.encryptor.getRSAKey()))},p.prototype.getEncryptor=function(){return this.encryptor||(this.encryptor=new o.encrypt.encryptor,this.encryptor.setAESStringKey(localStorage.getItem("encryptorAES")),this.encryptor.setSeq(localStorage.getItem("encryptorSeq")),this.encryptor.setHash(localStorage.getItem("encryptorHash")),this.encryptor.setRSAStringKey(localStorage.getItem("encryptorRsa"))),this.encryptor},p.prototype.cleanStorage=function(){localStorage.removeItem("encryptorAES"),localStorage.removeItem("encryptorSeq"),localStorage.removeItem("encryptorHash"),localStorage.removeItem("encryptorRsa")},new p)}(jQuery);