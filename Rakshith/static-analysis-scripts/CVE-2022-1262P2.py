import os
import argparse
from prettytable import PrettyTable

def find_protest_bin_files(folder_path):
    protest_bin_files = []

    for root, _, files in os.walk(folder_path):
        for filename in files:
            if filename == "protest.bin":
                protest_bin_files.append(os.path.join(root, filename))

    return protest_bin_files

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Detect protest binary files in a folder.')
    parser.add_argument('folder_path', type=str, help='Path to the folder to search for protest binary files')
    args = parser.parse_args()

    folder_path = args.folder_path
    protest_bin_files = find_protest_bin_files(folder_path)

    if protest_bin_files:
        table = PrettyTable()
        table.field_names = ["File Path"]
        for file_path in protest_bin_files:
            table.add_row([file_path])
        print(table)
    else:
        print("No protest binary files found in the folder.")

